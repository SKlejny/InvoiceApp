{"ast":null,"code":"var _jsxFileName = \"/workspaces/InvoiceApp/src/App.js\",\n  _s = $RefreshSig$();\n// src/App.js\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useMsal, useIsAuthenticated } from '@azure/msal-react';\nimport { InteractionRequiredAuthError } from '@azure/msal-browser';\n\n// Import components\nimport ConfirmModal from './components/ConfirmModal';\nimport EditFileModal from './components/EditFileModal';\nimport LoadingSpinner from './components/LoadingSpinner';\nimport ViewFileModal from './components/ViewFileModal';\nimport MessageDisplay from './components/MessageDisplay';\nimport ExcelChoiceModal from './components/ExcelChoiceModal';\nimport SettingsModal from './components/SettingsModal';\n\n// Import pages\nimport LoginPage from './pages/LoginPage';\nimport DashboardPage from './pages/DashboardPage';\nimport IncomingInvoicesPage from './pages/IncomingInvoicePage';\nimport PublishedDocumentsPage from './pages/PublishedDocumentsPage';\nimport ApprovedInvoicesPage from './pages/ApprovedInvoicesPage';\nimport SentDocumentsPage from './pages/SentDocumentsPage';\n\n// Import services and constants\nimport { fetchSharePointFiles, uploadFileToSharePoint, downloadFileFromSharePoint, updateSharePointFileContent, moveSharePointFile, logAuditTrail, fetchAuditTrails } from './services/sharepointService';\nimport { INCOMING_INVOICES_FOLDER_ITEM_ID, APPROVED_INVOICES_FOLDER_ITEM_ID, PUBLISHED_DOCUMENTS_FOLDER_ITEM_ID, SENT_FOLDER_ITEM_ID, FOLDER_NAMES, SHAREPOINT_SITE_ID, AUDIT_TRAIL_LIST_ID } from './utils/constants';\nimport { loginRequest } from './authConfig';\nimport { ThemeContext } from './contexts/ThemeContext';\n\n// Icons for App.js header\nimport { Upload, RefreshCw, Settings, ScrollText } from 'lucide-react';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  // NEW DIAGNOSTIC LOGS: Before state declarations\n  console.log('App component rendering. Top of function.');\n  console.log('Type of React.useState:', typeof useState); // Should be 'function'\n\n  const {\n    instance,\n    accounts\n  } = useMsal();\n  const isAuthenticated = useIsAuthenticated();\n  const [userProfile, setUserProfile] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [message, setMessage] = useState({\n    text: '',\n    type: ''\n  });\n  const [isDarkMode, setIsDarkMode] = useState(() => {\n    return localStorage.getItem('theme') === 'dark';\n  });\n  const [folders, setFolders] = useState({\n    [FOLDER_NAMES.INCOMING_INVOICES]: [],\n    [FOLDER_NAMES.APPROVED_INVOICES]: [],\n    [FOLDER_NAMES.PUBLISHED_DOCUMENTS]: [],\n    [FOLDER_NAMES.SENT_DOCUMENTS]: []\n  });\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n  const [isViewModalOpen, setIsViewModalOpen] = useState(false);\n  const [isConfirmModalOpen, setIsConfirmModalOpen] = useState(false);\n  const [isExcelChoiceModalOpen, setIsExcelChoiceModalOpen] = useState(false);\n  const [isSettingsModalOpen, setIsSettingsModalOpen] = useState(false);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [editedFileName, setEditedFileName] = useState('');\n  // NEW DIAGNOSTIC LOGS: Around the problematic state declaration\n  const [editedFileContent, setEditedFileContent] = useState('');\n  console.log('App component: typeof editedFileContent after declaration =', typeof editedFileContent); // Should be 'string'\n  console.log('App component: typeof setEditedFileContent after declaration =', typeof setEditedFileContent); // Should be 'function'\n  console.log('App component: value of setEditedFileContent after declaration =', setEditedFileContent); // Should show the function\n\n  const [confirmActionDetails, setConfirmActionDetails] = useState(null);\n  const [fileToOpenInExcel, setFileToOpenInExcel] = useState(null);\n  const [excelOpeningPreference, setExcelOpeningPreference] = useState(() => {\n    return localStorage.getItem('excelOpeningPreference') || 'ask';\n  });\n  const [currentPage, setCurrentPage] = useState('dashboard');\n  const [auditLogs, setAuditLogs] = useState([]);\n\n  // --- Helper Functions and Callbacks ---\n\n  const showMessage = useCallback((text, type) => {\n    setMessage({\n      text,\n      type\n    });\n  }, []);\n  const clearMessage = useCallback(() => {\n    setMessage({\n      text: '',\n      type: ''\n    });\n  }, []);\n  const toggleDarkMode = useCallback(() => {\n    setIsDarkMode(prevMode => {\n      const newMode = !prevMode;\n      localStorage.setItem('theme', newMode ? 'dark' : 'light');\n      return newMode;\n    });\n  }, []);\n  useEffect(() => {\n    localStorage.setItem('excelOpeningPreference', excelOpeningPreference);\n  }, [excelOpeningPreference]);\n  useEffect(() => {\n    if (isDarkMode) {\n      document.documentElement.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n    }\n  }, [isDarkMode]);\n  const fetchUserProfile = useCallback(async () => {\n    if (accounts.length > 0) {\n      try {\n        const response = await instance.acquireTokenSilent({\n          ...loginRequest,\n          account: accounts[0]\n        });\n        const graphResponse = await fetch('https://graph.microsoft.com/v1.0/me', {\n          headers: {\n            'Authorization': `Bearer ${response.accessToken}`\n          }\n        });\n        if (graphResponse.ok) {\n          const profile = await graphResponse.json();\n          setUserProfile(profile);\n        } else {\n          console.error(\"Failed to fetch user profile:\", await graphResponse.text());\n        }\n      } catch (error) {\n        console.error(\"Error acquiring token for user profile:\", error);\n        if (error instanceof InteractionRequiredAuthError) {\n          instance.acquireTokenRedirect(loginRequest);\n        }\n      }\n    }\n  }, [accounts, instance]);\n  const fetchSharePointData = useCallback(async () => {\n    setIsLoading(true);\n    try {\n      const allFolders = await fetchSharePointFiles(instance, accounts);\n      setFolders(allFolders);\n      showMessage('Files refreshed successfully!', 'success');\n    } catch (error) {\n      console.error(\"Error fetching SharePoint files:\", error);\n      showMessage(`Failed to load files: ${error.message}`, 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts, showMessage]);\n  const fetchAuditLogs = useCallback(async () => {\n    setIsLoading(true);\n    try {\n      const logs = await fetchAuditTrails(instance, accounts);\n      setAuditLogs(logs);\n    } catch (error) {\n      console.error(\"Error fetching audit logs:\", error);\n      showMessage(`Failed to load audit logs: ${error.message}`, 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts, showMessage]);\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchUserProfile();\n      fetchSharePointData();\n    }\n  }, [isAuthenticated, fetchUserProfile, fetchSharePointData]);\n\n  // --- MSAL Auth Handlers ---\n\n  const handleMicrosoftLogin = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      await instance.loginPopup(loginRequest);\n    } catch (error) {\n      console.error(\"Login failed:\", error);\n      showMessage(`Login failed: ${error.message}`, 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, showMessage]);\n  const handleLogout = useCallback(() => {\n    instance.logoutPopup();\n    setUserProfile(null);\n    setFolders({\n      [FOLDER_NAMES.INCOMING_INVOICES]: [],\n      [FOLDER_NAMES.APPROVED_INVOICES]: [],\n      [FOLDER_NAMES.PUBLISHED_DOCUMENTS]: [],\n      [FOLDER_NAMES.SENT_DOCUMENTS]: []\n    });\n    setCurrentPage('login');\n  }, [instance]);\n\n  // --- File Operations Handlers ---\n\n  const handleRefresh = useCallback(() => {\n    fetchSharePointData();\n  }, [fetchSharePointData]);\n  const handleUploadFile = useCallback(async (file, folderId) => {\n    setIsLoading(true);\n    try {\n      await uploadFileToSharePoint(file, folderId, instance, accounts);\n      showMessage('File uploaded successfully!', 'success');\n      fetchSharePointData();\n      logAuditTrail({\n        actionType: 'File Uploaded',\n        userName: (userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName) || 'Unknown User',\n        fileName: file.name,\n        fileId: 'N/A',\n        newLocation: folderId === INCOMING_INVOICES_FOLDER_ITEM_ID ? FOLDER_NAMES.INCOMING_INVOICES : 'Unknown Folder',\n        details: `Uploaded to ${folderId === INCOMING_INVOICES_FOLDER_ITEM_ID ? FOLDER_NAMES.INCOMING_INVOICES : 'Other Folder'}`\n      }, instance, accounts);\n    } catch (error) {\n      console.error('Upload failed:', error);\n      showMessage(`File upload failed: ${error.message}`, 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts, showMessage, fetchSharePointData, userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName]);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const handleDownloadAndSetContent = useCallback(async file => {\n    setIsLoading(true);\n    try {\n      const content = await downloadFileFromSharePoint(file, instance, accounts);\n      setEditedFileContent(content);\n      return content;\n    } catch (error) {\n      console.error('Download failed:', error);\n      showMessage(`Failed to get file content: ${error.message}`, 'error');\n      setEditedFileContent('');\n      return null;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts, showMessage]);\n  const handleEditClick = useCallback(async file => {\n    setSelectedFile(file);\n    setEditedFileName(file.name);\n    setIsEditModalOpen(true);\n    if (file.type !== 'xlsx') {\n      await handleDownloadAndSetContent(file);\n    } else {\n      // NEW DIAGNOSTIC LOGS: Before calling setEditedFileContent for XLSX in handleEditClick\n      console.log('handleEditClick: Inside XLSX block. About to call setEditedFileContent.');\n      console.log('handleEditClick: typeof setEditedFileContent =', typeof setEditedFileContent);\n      console.log('handleEditClick: value of setEditedFileContent =', setEditedFileContent);\n      setEditedFileContent('');\n    }\n  }, [handleDownloadAndSetContent, setEditedFileContent]); // Added setEditedFileContent to deps for safety\n\n  const openInExcelDesktop = useCallback(file => {\n    if (file && file.webUrl) {\n      const encodedUrl = encodeURIComponent(file.webUrl);\n      window.location.href = `ms-excel:ofe|u|${encodedUrl}`;\n      showMessage(`Attempting to open \"${file.name}\" in Excel desktop app.`, 'info');\n    }\n    setIsExcelChoiceModalOpen(false);\n    setFileToOpenInExcel(null);\n  }, [showMessage]);\n  const openInExcelWeb = useCallback(file => {\n    if (file && file.webUrl) {\n      window.open(file.webUrl, '_blank');\n      showMessage(`Opened \"${file.name}\" in Excel Online.`, 'success');\n    }\n    setIsExcelChoiceModalOpen(false);\n    setFileToOpenInExcel(null);\n  }, [showMessage]);\n  const handleSaveEdit = useCallback(async () => {\n    if (!selectedFile) return;\n    setIsConfirmModalOpen(false);\n    if (selectedFile.type === 'xlsx') {\n      if (excelOpeningPreference === 'web') {\n        openInExcelWeb(selectedFile);\n      } else if (excelOpeningPreference === 'desktop') {\n        openInExcelDesktop(selectedFile);\n      } else {\n        setFileToOpenInExcel(selectedFile);\n        setIsExcelChoiceModalOpen(true);\n      }\n      logAuditTrail({\n        actionType: `File Opened - ${excelOpeningPreference === 'web' ? 'Web' : 'Desktop App'}`,\n        userName: (userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName) || 'Unknown User',\n        fileName: selectedFile.name,\n        fileId: selectedFile.id,\n        details: `Opened for edit (Excel file)`\n      }, instance, accounts);\n      setIsEditModalOpen(false);\n      setSelectedFile(null);\n      setEditedFileName('');\n      setEditedFileContent(''); // <-- This line also calls setEditedFileContent\n      fetchSharePointData();\n      return;\n    }\n    setIsLoading(true);\n    try {\n      await updateSharePointFileContent(selectedFile.id, editedFileName, editedFileContent, instance, accounts);\n      showMessage('File updated successfully!', 'success');\n      logAuditTrail({\n        actionType: 'File Edited',\n        userName: (userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName) || 'Unknown User',\n        fileName: editedFileName,\n        fileId: selectedFile.id,\n        details: `Content and/or name updated. Original name: ${selectedFile.name}`\n      }, instance, accounts);\n      setIsEditModalOpen(false);\n      setSelectedFile(null);\n      setEditedFileName('');\n      setEditedFileContent('');\n      fetchSharePointData();\n    } catch (error) {\n      console.error('Save edit failed:', error);\n      showMessage(`Save failed: ${error.message}`, 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [selectedFile, editedFileName, editedFileContent, instance, accounts, fetchSharePointData, excelOpeningPreference, openInExcelWeb, openInExcelDesktop, userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName]);\n  const handleView = useCallback(async file => {\n    setSelectedFile(file);\n    setIsViewModalOpen(true);\n    if (file.type === 'xlsx' && file.webUrl) {\n      // NEW DIAGNOSTIC LOGS: Right before calling setEditedFileContent\n      console.log('handleView: Inside XLSX block. About to call setEditedFileContent.');\n      console.log('handleView: typeof setEditedFileContent =', typeof setEditedFileContent);\n      console.log('handleView: value of setEditedFileContent =', setEditedFileContent);\n      setEditedFileContent(''); // <-- The problematic line\n\n      if (excelOpeningPreference === 'web') {\n        openInExcelWeb(file);\n        setIsViewModalOpen(false);\n      } else if (excelOpeningPreference === 'desktop') {\n        openInExcelDesktop(file);\n        setIsViewModalOpen(false);\n      } else {\n        setFileToOpenInExcel(file);\n        setIsExcelChoiceModalOpen(true);\n        setIsViewModalOpen(false);\n      }\n      logAuditTrail({\n        actionType: `File Viewed - ${excelOpeningPreference === 'web' ? 'Web' : 'Desktop App'}`,\n        userName: (userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName) || 'Unknown User',\n        fileName: file.name,\n        fileId: file.id,\n        details: `Viewed (Excel file)`\n      }, instance, accounts);\n    } else {\n      await handleDownloadAndSetContent(file);\n      logAuditTrail({\n        actionType: 'File Viewed',\n        userName: (userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName) || 'Unknown User',\n        fileName: file.name,\n        fileId: file.id,\n        details: `Viewed (PDF/Text/Image file)`\n      }, instance, accounts);\n    }\n  }, [handleDownloadAndSetContent, showMessage, excelOpeningPreference, openInExcelWeb, openInExcelDesktop, userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName, setEditedFileContent]); // Added setEditedFileContent to deps for safety\n\n  const handleApprove = useCallback(fileId => {\n    setConfirmActionDetails({\n      type: 'approve',\n      fileId: fileId,\n      message: 'Are you sure you want to approve this invoice and move it to Approved Invoices?'\n    });\n    setIsConfirmModalOpen(true);\n  }, []);\n  const handleSent = useCallback(fileId => {\n    setConfirmActionDetails({\n      type: 'sent',\n      fileId: fileId,\n      message: 'Are you sure you want to mark this document as sent and move it to Sent Documents?'\n    });\n    setIsConfirmModalOpen(true);\n  }, []);\n  const handleConfirmAction = useCallback(async () => {\n    if (!confirmActionDetails) return;\n    setIsConfirmModalOpen(false);\n    setIsLoading(true);\n    const {\n      type,\n      fileId\n    } = confirmActionDetails;\n    let successMessage = '';\n    let errorMessage = '';\n    let actionType = '';\n    let oldLoc = '';\n    let newLoc = '';\n    const fileAffected = folders[currentPage].find(f => f.id === fileId);\n    try {\n      if (type === 'approve') {\n        actionType = 'Invoice Approved';\n        oldLoc = FOLDER_NAMES.INCOMING_INVOICES;\n        newLoc = FOLDER_NAMES.APPROVED_INVOICES;\n        await moveSharePointFile(fileId, INCOMING_INVOICES_FOLDER_ITEM_ID, APPROVED_INVOICES_FOLDER_ITEM_ID, instance, accounts);\n        successMessage = 'Invoice approved and moved successfully!';\n      } else if (type === 'sent') {\n        actionType = 'Document Marked Sent';\n        oldLoc = FOLDER_NAMES.PUBLISHED_DOCUMENTS;\n        newLoc = FOLDER_NAMES.SENT_DOCUMENTS;\n        await moveSharePointFile(fileId, PUBLISHED_DOCUMENTS_FOLDER_ITEM_ID, SENT_FOLDER_ITEM_ID, instance, accounts);\n        successMessage = 'Document marked as sent and moved successfully!';\n      }\n      showMessage(successMessage, 'success');\n      fetchSharePointData();\n      logAuditTrail({\n        actionType: actionType,\n        userName: (userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName) || 'Unknown User',\n        fileName: (fileAffected === null || fileAffected === void 0 ? void 0 : fileAffected.name) || 'N/A',\n        fileId: fileId,\n        oldLocation: oldLoc,\n        newLocation: newLoc,\n        details: `Moved from ${oldLoc} to ${newLoc}`\n      }, instance, accounts);\n    } catch (error) {\n      console.error(`Action \"${type}\" failed:`, error);\n      errorMessage = `Action failed: ${error.message}`;\n      showMessage(errorMessage, 'error');\n    } finally {\n      setIsLoading(false);\n      setConfirmActionDetails(null);\n    }\n  }, [confirmActionDetails, instance, accounts, fetchSharePointData, showMessage, folders, currentPage, userProfile === null || userProfile === void 0 ? void 0 : userProfile.displayName]);\n  const handleOpenSettings = useCallback(() => {\n    setIsSettingsModalOpen(true);\n  }, []);\n  const handleCloseSettings = useCallback(() => {\n    setIsSettingsModalOpen(false);\n  }, []);\n\n  // eslint-disable-next-line no-unused-vars\n  const handleSetExcelOpeningPreference = useCallback(preference => {\n    setExcelOpeningPreference(preference);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(ThemeContext.Provider, {\n    value: {\n      isDarkMode,\n      toggleDarkMode\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative min-h-screen flex flex-col\",\n      children: [isLoading && /*#__PURE__*/_jsxDEV(LoadingSpinner, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 23\n      }, this), /*#__PURE__*/_jsxDEV(MessageDisplay, {\n        message: message,\n        onClearMessage: clearMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ExcelChoiceModal, {\n        isOpen: isExcelChoiceModalOpen,\n        onClose: () => setIsExcelChoiceModalOpen(false),\n        fileName: (fileToOpenInExcel === null || fileToOpenInExcel === void 0 ? void 0 : fileToOpenInExcel.name) || '',\n        onOpenWeb: () => openInExcelWeb(fileToOpenInExcel),\n        onOpenDesktop: () => openInExcelDesktop(fileToOpenInExcel)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 494,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SettingsModal, {\n        isOpen: isSettingsModalOpen,\n        onClose: handleCloseSettings,\n        currentExcelPreference: excelOpeningPreference,\n        onPreferenceChange: preference => setExcelOpeningPreference(preference),\n        isDarkMode: isDarkMode,\n        toggleDarkMode: toggleDarkMode\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"flex-grow\",\n        children: !isAuthenticated ? /*#__PURE__*/_jsxDEV(LoginPage, {\n          onLogin: handleMicrosoftLogin\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"header\", {\n            className: \"flex justify-between items-center p-4 bg-light-bg-card shadow-md  dark:bg-dark-bg-card dark:text-text-primary-dark dark:border-b dark:border-border-subtle-dark\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-2xl font-bold text-text-primary-light dark:text-text-primary-dark\",\n              children: \"Invoice System\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 518,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                id: \"fileUploadInput\",\n                style: {\n                  display: 'none'\n                },\n                onChange: e => {\n                  if (e.target.files && e.target.files[0]) {\n                    handleUploadFile(e.target.files[0], INCOMING_INVOICES_FOLDER_ITEM_ID);\n                    e.target.value = '';\n                  }\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 521,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => document.getElementById('fileUploadInput').click(),\n                className: \"px-4 py-2 bg-brand-orange-light text-white rounded-lg shadow-md  hover:bg-brand-orange-dark transition duration-200 flex items-center\",\n                \"aria-label\": \"Upload new file\",\n                children: [/*#__PURE__*/_jsxDEV(Upload, {\n                  size: 18,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 538,\n                  columnNumber: 21\n                }, this), \" Upload File\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 532,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleRefresh,\n                className: \"px-4 py-2 bg-ui-blue-light/10 text-ui-blue-light rounded-lg shadow-md  hover:bg-ui-blue-light/20 transition-colors duration-300 flex items-center  dark:bg-ui-blue-dark/10 dark:text-ui-blue-dark dark:hover:bg-ui-blue-dark/20\",\n                \"aria-label\": \"Refresh file list\",\n                children: [/*#__PURE__*/_jsxDEV(RefreshCw, {\n                  size: 18,\n                  className: \"mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 548,\n                  columnNumber: 21\n                }, this), \" Refresh Files\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 541,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleOpenSettings,\n                className: \"px-4 py-2 bg-ui-blue-light/10 text-ui-blue-light rounded-lg shadow-md  hover:bg-ui-blue-light/20 transition-colors duration-300 flex items-center  dark:bg-ui-blue-dark/10 dark:text-ui-blue-dark dark:hover:bg-ui-blue-dark/20\",\n                \"aria-label\": \"Open settings\",\n                children: /*#__PURE__*/_jsxDEV(Settings, {\n                  size: 18\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 558,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 551,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 520,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 516,\n            columnNumber: 15\n          }, this), currentPage === 'dashboard' && /*#__PURE__*/_jsxDEV(DashboardPage, {\n            userProfile: userProfile,\n            folders: folders,\n            setCurrentPage: setCurrentPage,\n            onLogout: handleLogout\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 564,\n            columnNumber: 17\n          }, this), currentPage === 'incomingInvoices' && /*#__PURE__*/_jsxDEV(IncomingInvoicesPage, {\n            files: folders[FOLDER_NAMES.INCOMING_INVOICES],\n            setCurrentPage: setCurrentPage,\n            onEdit: handleEditClick,\n            onApprove: handleApprove,\n            onView: handleView\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 17\n          }, this), currentPage === 'publishedDocuments' && /*#__PURE__*/_jsxDEV(PublishedDocumentsPage, {\n            files: folders[FOLDER_NAMES.PUBLISHED_DOCUMENTS],\n            setCurrentPage: setCurrentPage,\n            onView: handleView,\n            onSent: handleSent\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 17\n          }, this), currentPage === 'approvedInvoices' && /*#__PURE__*/_jsxDEV(ApprovedInvoicesPage, {\n            files: folders[FOLDER_NAMES.APPROVED_INVOICES],\n            setCurrentPage: setCurrentPage,\n            onView: handleView\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 589,\n            columnNumber: 17\n          }, this), currentPage === 'sentDocuments' && /*#__PURE__*/_jsxDEV(SentDocumentsPage, {\n            files: folders[FOLDER_NAMES.SENT_DOCUMENTS],\n            setCurrentPage: setCurrentPage,\n            onView: handleView\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 596,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 511,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(EditFileModal, {\n        isOpen: isEditModalOpen,\n        onClose: () => {\n          setIsEditModalOpen(false);\n          if (selectedFile && (selectedFile.type === 'pdf' || selectedFile.type === 'image' || selectedFile.type === 'other') && editedFileContent && typeof editedFileContent === 'string' && editedFileContent.startsWith('blob:')) {\n            URL.revokeObjectURL(editedFileContent);\n          }\n          setSelectedFile(null);\n          setEditedFileName('');\n          setEditedFileContent('');\n        },\n        fileName: editedFileName,\n        onFileNameChange: e => setEditedFileName(e.target.value),\n        fileContent: editedFileContent,\n        onFileContentChange: e => setEditedFileContent(e.target.value),\n        onSave: handleSaveEdit,\n        selectedFileType: selectedFile === null || selectedFile === void 0 ? void 0 : selectedFile.type,\n        selectedFileMimeType: selectedFile === null || selectedFile === void 0 ? void 0 : selectedFile.mimeType\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 606,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ViewFileModal, {\n        isOpen: isViewModalOpen,\n        onClose: () => {\n          setIsViewModalOpen(false);\n          if (selectedFile && (selectedFile.type === 'pdf' || selectedFile.type === 'image' || selectedFile.type === 'other') && editedFileContent && typeof editedFileContent === 'string' && editedFileContent.startsWith('blob:')) {\n            URL.revokeObjectURL(editedFileContent);\n          }\n          setSelectedFile(null);\n          setEditedFileContent('');\n        },\n        fileName: (selectedFile === null || selectedFile === void 0 ? void 0 : selectedFile.name) || '',\n        fileContent: editedFileContent,\n        selectedFileType: selectedFile === null || selectedFile === void 0 ? void 0 : selectedFile.type,\n        selectedFileMimeType: selectedFile === null || selectedFile === void 0 ? void 0 : selectedFile.mimeType\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 625,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ConfirmModal, {\n        isOpen: isConfirmModalOpen,\n        onClose: () => setIsConfirmModalOpen(false),\n        onConfirm: handleConfirmAction,\n        message: (confirmActionDetails === null || confirmActionDetails === void 0 ? void 0 : confirmActionDetails.message) || \"Are you sure you want to proceed?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 641,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 489,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 488,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"p22UKH16IaDCdHdu8YmSxAwMJ98=\", false, function () {\n  return [useMsal, useIsAuthenticated];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMsal","useIsAuthenticated","InteractionRequiredAuthError","ConfirmModal","EditFileModal","LoadingSpinner","ViewFileModal","MessageDisplay","ExcelChoiceModal","SettingsModal","LoginPage","DashboardPage","IncomingInvoicesPage","PublishedDocumentsPage","ApprovedInvoicesPage","SentDocumentsPage","fetchSharePointFiles","uploadFileToSharePoint","downloadFileFromSharePoint","updateSharePointFileContent","moveSharePointFile","logAuditTrail","fetchAuditTrails","INCOMING_INVOICES_FOLDER_ITEM_ID","APPROVED_INVOICES_FOLDER_ITEM_ID","PUBLISHED_DOCUMENTS_FOLDER_ITEM_ID","SENT_FOLDER_ITEM_ID","FOLDER_NAMES","SHAREPOINT_SITE_ID","AUDIT_TRAIL_LIST_ID","loginRequest","ThemeContext","Upload","RefreshCw","Settings","ScrollText","jsxDEV","_jsxDEV","Fragment","_Fragment","App","_s","console","log","instance","accounts","isAuthenticated","userProfile","setUserProfile","isLoading","setIsLoading","message","setMessage","text","type","isDarkMode","setIsDarkMode","localStorage","getItem","folders","setFolders","INCOMING_INVOICES","APPROVED_INVOICES","PUBLISHED_DOCUMENTS","SENT_DOCUMENTS","isEditModalOpen","setIsEditModalOpen","isViewModalOpen","setIsViewModalOpen","isConfirmModalOpen","setIsConfirmModalOpen","isExcelChoiceModalOpen","setIsExcelChoiceModalOpen","isSettingsModalOpen","setIsSettingsModalOpen","selectedFile","setSelectedFile","editedFileName","setEditedFileName","editedFileContent","setEditedFileContent","confirmActionDetails","setConfirmActionDetails","fileToOpenInExcel","setFileToOpenInExcel","excelOpeningPreference","setExcelOpeningPreference","currentPage","setCurrentPage","auditLogs","setAuditLogs","showMessage","clearMessage","toggleDarkMode","prevMode","newMode","setItem","document","documentElement","classList","add","remove","fetchUserProfile","length","response","acquireTokenSilent","account","graphResponse","fetch","headers","accessToken","ok","profile","json","error","acquireTokenRedirect","fetchSharePointData","allFolders","fetchAuditLogs","logs","handleMicrosoftLogin","loginPopup","handleLogout","logoutPopup","handleRefresh","handleUploadFile","file","folderId","actionType","userName","displayName","fileName","name","fileId","newLocation","details","handleDownloadAndSetContent","content","handleEditClick","openInExcelDesktop","webUrl","encodedUrl","encodeURIComponent","window","location","href","openInExcelWeb","open","handleSaveEdit","id","handleView","handleApprove","handleSent","handleConfirmAction","successMessage","errorMessage","oldLoc","newLoc","fileAffected","find","f","oldLocation","handleOpenSettings","handleCloseSettings","handleSetExcelOpeningPreference","preference","Provider","value","children","className","_jsxFileName","lineNumber","columnNumber","onClearMessage","isOpen","onClose","onOpenWeb","onOpenDesktop","currentExcelPreference","onPreferenceChange","onLogin","style","display","onChange","e","target","files","onClick","getElementById","click","size","onLogout","onEdit","onApprove","onView","onSent","startsWith","URL","revokeObjectURL","onFileNameChange","fileContent","onFileContentChange","onSave","selectedFileType","selectedFileMimeType","mimeType","onConfirm","_c","$RefreshReg$"],"sources":["/workspaces/InvoiceApp/src/App.js"],"sourcesContent":["// src/App.js\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useMsal, useIsAuthenticated } from '@azure/msal-react';\nimport { InteractionRequiredAuthError } from '@azure/msal-browser';\n\n// Import components\nimport ConfirmModal from './components/ConfirmModal';\nimport EditFileModal from './components/EditFileModal';\nimport LoadingSpinner from './components/LoadingSpinner';\nimport ViewFileModal from './components/ViewFileModal';\nimport MessageDisplay from './components/MessageDisplay';\nimport ExcelChoiceModal from './components/ExcelChoiceModal';\nimport SettingsModal from './components/SettingsModal';\n\n// Import pages\nimport LoginPage from './pages/LoginPage';\nimport DashboardPage from './pages/DashboardPage';\nimport IncomingInvoicesPage from './pages/IncomingInvoicePage';\nimport PublishedDocumentsPage from './pages/PublishedDocumentsPage';\nimport ApprovedInvoicesPage from './pages/ApprovedInvoicesPage';\nimport SentDocumentsPage from './pages/SentDocumentsPage';\n\n// Import services and constants\nimport {\n  fetchSharePointFiles,\n  uploadFileToSharePoint,\n  downloadFileFromSharePoint,\n  updateSharePointFileContent,\n  moveSharePointFile,\n  logAuditTrail,\n  fetchAuditTrails\n} from './services/sharepointService';\nimport {\n  INCOMING_INVOICES_FOLDER_ITEM_ID,\n  APPROVED_INVOICES_FOLDER_ITEM_ID,\n  PUBLISHED_DOCUMENTS_FOLDER_ITEM_ID,\n  SENT_FOLDER_ITEM_ID,\n  FOLDER_NAMES,\n  SHAREPOINT_SITE_ID,\n  AUDIT_TRAIL_LIST_ID\n} from './utils/constants';\nimport { loginRequest } from './authConfig';\nimport { ThemeContext } from './contexts/ThemeContext';\n\n// Icons for App.js header\nimport { Upload, RefreshCw, Settings, ScrollText } from 'lucide-react';\n\n\nfunction App() {\n  // NEW DIAGNOSTIC LOGS: Before state declarations\n  console.log('App component rendering. Top of function.');\n  console.log('Type of React.useState:', typeof useState); // Should be 'function'\n\n  const { instance, accounts } = useMsal();\n  const isAuthenticated = useIsAuthenticated();\n\n  const [userProfile, setUserProfile] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [message, setMessage] = useState({ text: '', type: '' });\n  const [isDarkMode, setIsDarkMode] = useState(() => {\n    return localStorage.getItem('theme') === 'dark';\n  });\n\n  const [folders, setFolders] = useState({\n    [FOLDER_NAMES.INCOMING_INVOICES]: [],\n    [FOLDER_NAMES.APPROVED_INVOICES]: [],\n    [FOLDER_NAMES.PUBLISHED_DOCUMENTS]: [],\n    [FOLDER_NAMES.SENT_DOCUMENTS]: [],\n  });\n\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n  const [isViewModalOpen, setIsViewModalOpen] = useState(false);\n  const [isConfirmModalOpen, setIsConfirmModalOpen] = useState(false);\n  const [isExcelChoiceModalOpen, setIsExcelChoiceModalOpen] = useState(false);\n  const [isSettingsModalOpen, setIsSettingsModalOpen] = useState(false);\n\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [editedFileName, setEditedFileName] = useState('');\n  // NEW DIAGNOSTIC LOGS: Around the problematic state declaration\n  const [editedFileContent, setEditedFileContent] = useState('');\n  console.log('App component: typeof editedFileContent after declaration =', typeof editedFileContent); // Should be 'string'\n  console.log('App component: typeof setEditedFileContent after declaration =', typeof setEditedFileContent); // Should be 'function'\n  console.log('App component: value of setEditedFileContent after declaration =', setEditedFileContent); // Should show the function\n\n  const [confirmActionDetails, setConfirmActionDetails] = useState(null);\n  const [fileToOpenInExcel, setFileToOpenInExcel] = useState(null);\n  const [excelOpeningPreference, setExcelOpeningPreference] = useState(() => {\n    return localStorage.getItem('excelOpeningPreference') || 'ask';\n  });\n\n\n  const [currentPage, setCurrentPage] = useState('dashboard');\n  const [auditLogs, setAuditLogs] = useState([]);\n\n\n  // --- Helper Functions and Callbacks ---\n\n  const showMessage = useCallback((text, type) => {\n    setMessage({ text, type });\n  }, []);\n\n  const clearMessage = useCallback(() => {\n    setMessage({ text: '', type: '' });\n  }, []);\n\n\n  const toggleDarkMode = useCallback(() => {\n    setIsDarkMode(prevMode => {\n      const newMode = !prevMode;\n      localStorage.setItem('theme', newMode ? 'dark' : 'light');\n      return newMode;\n    });\n  }, []);\n\n  useEffect(() => {\n    localStorage.setItem('excelOpeningPreference', excelOpeningPreference);\n  }, [excelOpeningPreference]);\n\n  useEffect(() => {\n    if (isDarkMode) {\n      document.documentElement.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n    }\n  }, [isDarkMode]);\n\n\n  const fetchUserProfile = useCallback(async () => {\n    if (accounts.length > 0) {\n      try {\n        const response = await instance.acquireTokenSilent({\n          ...loginRequest,\n          account: accounts[0]\n        });\n        const graphResponse = await fetch('https://graph.microsoft.com/v1.0/me', {\n          headers: {\n            'Authorization': `Bearer ${response.accessToken}`\n          }\n        });\n        if (graphResponse.ok) {\n          const profile = await graphResponse.json();\n          setUserProfile(profile);\n        } else {\n          console.error(\"Failed to fetch user profile:\", await graphResponse.text());\n        }\n      } catch (error) {\n        console.error(\"Error acquiring token for user profile:\", error);\n        if (error instanceof InteractionRequiredAuthError) {\n          instance.acquireTokenRedirect(loginRequest);\n        }\n      }\n    }\n  }, [accounts, instance]);\n\n\n  const fetchSharePointData = useCallback(async () => {\n    setIsLoading(true);\n    try {\n      const allFolders = await fetchSharePointFiles(instance, accounts);\n      setFolders(allFolders);\n      showMessage('Files refreshed successfully!', 'success');\n    } catch (error) {\n      console.error(\"Error fetching SharePoint files:\", error);\n      showMessage(`Failed to load files: ${error.message}`, 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts, showMessage]);\n\n  const fetchAuditLogs = useCallback(async () => {\n    setIsLoading(true);\n    try {\n        const logs = await fetchAuditTrails(instance, accounts);\n        setAuditLogs(logs);\n    } catch (error) {\n        console.error(\"Error fetching audit logs:\", error);\n        showMessage(`Failed to load audit logs: ${error.message}`, 'error');\n    } finally {\n        setIsLoading(false);\n    }\n  }, [instance, accounts, showMessage]);\n\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchUserProfile();\n      fetchSharePointData();\n    }\n  }, [isAuthenticated, fetchUserProfile, fetchSharePointData]);\n\n\n  // --- MSAL Auth Handlers ---\n\n  const handleMicrosoftLogin = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      await instance.loginPopup(loginRequest);\n    } catch (error) {\n      console.error(\"Login failed:\", error);\n      showMessage(`Login failed: ${error.message}`, 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, showMessage]);\n\n  const handleLogout = useCallback(() => {\n    instance.logoutPopup();\n    setUserProfile(null);\n    setFolders({\n      [FOLDER_NAMES.INCOMING_INVOICES]: [],\n      [FOLDER_NAMES.APPROVED_INVOICES]: [],\n      [FOLDER_NAMES.PUBLISHED_DOCUMENTS]: [],\n      [FOLDER_NAMES.SENT_DOCUMENTS]: [],\n    });\n    setCurrentPage('login');\n  }, [instance]);\n\n\n  // --- File Operations Handlers ---\n\n  const handleRefresh = useCallback(() => {\n    fetchSharePointData();\n  }, [fetchSharePointData]);\n\n\n  const handleUploadFile = useCallback(async (file, folderId) => {\n    setIsLoading(true);\n    try {\n      await uploadFileToSharePoint(file, folderId, instance, accounts);\n      showMessage('File uploaded successfully!', 'success');\n      fetchSharePointData();\n      logAuditTrail({\n          actionType: 'File Uploaded',\n          userName: userProfile?.displayName || 'Unknown User',\n          fileName: file.name,\n          fileId: 'N/A',\n          newLocation: folderId === INCOMING_INVOICES_FOLDER_ITEM_ID ? FOLDER_NAMES.INCOMING_INVOICES : 'Unknown Folder',\n          details: `Uploaded to ${folderId === INCOMING_INVOICES_FOLDER_ITEM_ID ? FOLDER_NAMES.INCOMING_INVOICES : 'Other Folder'}`\n      }, instance, accounts);\n    } catch (error) {\n      console.error('Upload failed:', error);\n      showMessage(`File upload failed: ${error.message}`, 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts, showMessage, fetchSharePointData, userProfile?.displayName]);\n\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const handleDownloadAndSetContent = useCallback(async (file) => {\n    setIsLoading(true);\n    try {\n      const content = await downloadFileFromSharePoint(file, instance, accounts);\n      setEditedFileContent(content);\n      return content;\n    } catch (error) {\n      console.error('Download failed:', error);\n      showMessage(`Failed to get file content: ${error.message}`, 'error');\n      setEditedFileContent('');\n      return null;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts, showMessage]);\n\n\n  const handleEditClick = useCallback(async (file) => {\n    setSelectedFile(file);\n    setEditedFileName(file.name);\n    setIsEditModalOpen(true);\n    if (file.type !== 'xlsx') {\n      await handleDownloadAndSetContent(file);\n    } else {\n      // NEW DIAGNOSTIC LOGS: Before calling setEditedFileContent for XLSX in handleEditClick\n      console.log('handleEditClick: Inside XLSX block. About to call setEditedFileContent.');\n      console.log('handleEditClick: typeof setEditedFileContent =', typeof setEditedFileContent);\n      console.log('handleEditClick: value of setEditedFileContent =', setEditedFileContent);\n      setEditedFileContent('');\n    }\n  }, [handleDownloadAndSetContent, setEditedFileContent]); // Added setEditedFileContent to deps for safety\n\n\n  const openInExcelDesktop = useCallback((file) => {\n    if (file && file.webUrl) {\n      const encodedUrl = encodeURIComponent(file.webUrl);\n      window.location.href = `ms-excel:ofe|u|${encodedUrl}`;\n      showMessage(`Attempting to open \"${file.name}\" in Excel desktop app.`, 'info');\n    }\n    setIsExcelChoiceModalOpen(false);\n    setFileToOpenInExcel(null);\n  }, [showMessage]);\n\n  const openInExcelWeb = useCallback((file) => {\n    if (file && file.webUrl) {\n      window.open(file.webUrl, '_blank');\n      showMessage(`Opened \"${file.name}\" in Excel Online.`, 'success');\n    }\n    setIsExcelChoiceModalOpen(false);\n    setFileToOpenInExcel(null);\n  }, [showMessage]);\n\n\n  const handleSaveEdit = useCallback(async () => {\n    if (!selectedFile) return;\n\n    setIsConfirmModalOpen(false);\n\n    if (selectedFile.type === 'xlsx') {\n      if (excelOpeningPreference === 'web') {\n        openInExcelWeb(selectedFile);\n      } else if (excelOpeningPreference === 'desktop') {\n        openInExcelDesktop(selectedFile);\n      } else {\n        setFileToOpenInExcel(selectedFile);\n        setIsExcelChoiceModalOpen(true);\n      }\n      logAuditTrail({\n          actionType: `File Opened - ${excelOpeningPreference === 'web' ? 'Web' : 'Desktop App'}`,\n          userName: userProfile?.displayName || 'Unknown User',\n          fileName: selectedFile.name,\n          fileId: selectedFile.id,\n          details: `Opened for edit (Excel file)`\n      }, instance, accounts);\n\n      setIsEditModalOpen(false);\n      setSelectedFile(null);\n      setEditedFileName('');\n      setEditedFileContent(''); // <-- This line also calls setEditedFileContent\n      fetchSharePointData();\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      await updateSharePointFileContent(selectedFile.id, editedFileName, editedFileContent, instance, accounts);\n      showMessage('File updated successfully!', 'success');\n      logAuditTrail({\n          actionType: 'File Edited',\n          userName: userProfile?.displayName || 'Unknown User',\n          fileName: editedFileName,\n          fileId: selectedFile.id,\n          details: `Content and/or name updated. Original name: ${selectedFile.name}`\n      }, instance, accounts);\n\n      setIsEditModalOpen(false);\n      setSelectedFile(null);\n      setEditedFileName('');\n      setEditedFileContent('');\n      fetchSharePointData();\n    } catch (error) {\n      console.error('Save edit failed:', error);\n      showMessage(`Save failed: ${error.message}`, 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [selectedFile, editedFileName, editedFileContent, instance, accounts, fetchSharePointData, excelOpeningPreference, openInExcelWeb, openInExcelDesktop, userProfile?.displayName]);\n\n\n  const handleView = useCallback(async (file) => {\n    setSelectedFile(file);\n    setIsViewModalOpen(true);\n\n    if (file.type === 'xlsx' && file.webUrl) {\n      // NEW DIAGNOSTIC LOGS: Right before calling setEditedFileContent\n      console.log('handleView: Inside XLSX block. About to call setEditedFileContent.');\n      console.log('handleView: typeof setEditedFileContent =', typeof setEditedFileContent);\n      console.log('handleView: value of setEditedFileContent =', setEditedFileContent);\n\n      setEditedFileContent(''); // <-- The problematic line\n      \n      if (excelOpeningPreference === 'web') {\n        openInExcelWeb(file);\n        setIsViewModalOpen(false);\n      } else if (excelOpeningPreference === 'desktop') {\n        openInExcelDesktop(file);\n        setIsViewModalOpen(false);\n      } else {\n        setFileToOpenInExcel(file);\n        setIsExcelChoiceModalOpen(true);\n        setIsViewModalOpen(false);\n      }\n      logAuditTrail({\n          actionType: `File Viewed - ${excelOpeningPreference === 'web' ? 'Web' : 'Desktop App'}`,\n          userName: userProfile?.displayName || 'Unknown User',\n          fileName: file.name,\n          fileId: file.id,\n          details: `Viewed (Excel file)`\n      }, instance, accounts);\n    } else {\n      await handleDownloadAndSetContent(file);\n      logAuditTrail({\n          actionType: 'File Viewed',\n          userName: userProfile?.displayName || 'Unknown User',\n          fileName: file.name,\n          fileId: file.id,\n          details: `Viewed (PDF/Text/Image file)`\n      }, instance, accounts);\n    }\n  }, [handleDownloadAndSetContent, showMessage, excelOpeningPreference, openInExcelWeb, openInExcelDesktop, userProfile?.displayName, setEditedFileContent]); // Added setEditedFileContent to deps for safety\n\n\n  const handleApprove = useCallback((fileId) => {\n    setConfirmActionDetails({\n      type: 'approve',\n      fileId: fileId,\n      message: 'Are you sure you want to approve this invoice and move it to Approved Invoices?'\n    });\n    setIsConfirmModalOpen(true);\n  }, []);\n\n  const handleSent = useCallback((fileId) => {\n    setConfirmActionDetails({\n      type: 'sent',\n      fileId: fileId,\n      message: 'Are you sure you want to mark this document as sent and move it to Sent Documents?'\n    });\n    setIsConfirmModalOpen(true);\n  }, []);\n\n\n  const handleConfirmAction = useCallback(async () => {\n    if (!confirmActionDetails) return;\n\n    setIsConfirmModalOpen(false);\n    setIsLoading(true);\n\n    const { type, fileId } = confirmActionDetails;\n    let successMessage = '';\n    let errorMessage = '';\n    let actionType = '';\n    let oldLoc = '';\n    let newLoc = '';\n    const fileAffected = folders[currentPage].find(f => f.id === fileId);\n\n    try {\n      if (type === 'approve') {\n        actionType = 'Invoice Approved';\n        oldLoc = FOLDER_NAMES.INCOMING_INVOICES;\n        newLoc = FOLDER_NAMES.APPROVED_INVOICES;\n        await moveSharePointFile(fileId, INCOMING_INVOICES_FOLDER_ITEM_ID, APPROVED_INVOICES_FOLDER_ITEM_ID, instance, accounts);\n        successMessage = 'Invoice approved and moved successfully!';\n      } else if (type === 'sent') {\n        actionType = 'Document Marked Sent';\n        oldLoc = FOLDER_NAMES.PUBLISHED_DOCUMENTS;\n        newLoc = FOLDER_NAMES.SENT_DOCUMENTS;\n        await moveSharePointFile(fileId, PUBLISHED_DOCUMENTS_FOLDER_ITEM_ID, SENT_FOLDER_ITEM_ID, instance, accounts);\n        successMessage = 'Document marked as sent and moved successfully!';\n      }\n      showMessage(successMessage, 'success');\n      fetchSharePointData();\n      logAuditTrail({\n          actionType: actionType,\n          userName: userProfile?.displayName || 'Unknown User',\n          fileName: fileAffected?.name || 'N/A',\n          fileId: fileId,\n          oldLocation: oldLoc,\n          newLocation: newLoc,\n          details: `Moved from ${oldLoc} to ${newLoc}`\n      }, instance, accounts);\n\n    } catch (error) {\n      console.error(`Action \"${type}\" failed:`, error);\n      errorMessage = `Action failed: ${error.message}`;\n      showMessage(errorMessage, 'error');\n    } finally {\n      setIsLoading(false);\n      setConfirmActionDetails(null);\n    }\n  }, [confirmActionDetails, instance, accounts, fetchSharePointData, showMessage, folders, currentPage, userProfile?.displayName]);\n\n\n  const handleOpenSettings = useCallback(() => {\n    setIsSettingsModalOpen(true);\n  }, []);\n\n  const handleCloseSettings = useCallback(() => {\n    setIsSettingsModalOpen(false);\n  }, []);\n\n  // eslint-disable-next-line no-unused-vars\n  const handleSetExcelOpeningPreference = useCallback((preference) => {\n    setExcelOpeningPreference(preference);\n  }, []);\n\n\n  return (\n    <ThemeContext.Provider value={{ isDarkMode, toggleDarkMode }}>\n      <div className=\"relative min-h-screen flex flex-col\">\n        {isLoading && <LoadingSpinner />}\n\n        <MessageDisplay message={message} onClearMessage={clearMessage} />\n\n        <ExcelChoiceModal\n          isOpen={isExcelChoiceModalOpen}\n          onClose={() => setIsExcelChoiceModalOpen(false)}\n          fileName={fileToOpenInExcel?.name || ''}\n          onOpenWeb={() => openInExcelWeb(fileToOpenInExcel)}\n          onOpenDesktop={() => openInExcelDesktop(fileToOpenInExcel)}\n        />\n\n        <SettingsModal\n          isOpen={isSettingsModalOpen}\n          onClose={handleCloseSettings}\n          currentExcelPreference={excelOpeningPreference}\n          onPreferenceChange={(preference) => setExcelOpeningPreference(preference)}\n          isDarkMode={isDarkMode}\n          toggleDarkMode={toggleDarkMode}\n        />\n\n        <main className=\"flex-grow\">\n          {!isAuthenticated ? (\n            <LoginPage onLogin={handleMicrosoftLogin} />\n          ) : (\n            <>\n              <header className=\"flex justify-between items-center p-4 bg-light-bg-card shadow-md \n                                 dark:bg-dark-bg-card dark:text-text-primary-dark dark:border-b dark:border-border-subtle-dark\">\n                <h1 className=\"text-2xl font-bold text-text-primary-light dark:text-text-primary-dark\">Invoice System</h1>\n                \n                <div className=\"flex space-x-4\">\n                  <input\n                    type=\"file\"\n                    id=\"fileUploadInput\"\n                    style={{ display: 'none' }}\n                    onChange={(e) => {\n                      if (e.target.files && e.target.files[0]) {\n                        handleUploadFile(e.target.files[0], INCOMING_INVOICES_FOLDER_ITEM_ID);\n                        e.target.value = '';\n                      }\n                    }}\n                  />\n                  <button\n                    onClick={() => document.getElementById('fileUploadInput').click()}\n                    className=\"px-4 py-2 bg-brand-orange-light text-white rounded-lg shadow-md \n                               hover:bg-brand-orange-dark transition duration-200 flex items-center\"\n                    aria-label=\"Upload new file\"\n                  >\n                    <Upload size={18} className=\"mr-2\" /> Upload File\n                  </button>\n\n                  <button\n                    onClick={handleRefresh}\n                    className=\"px-4 py-2 bg-ui-blue-light/10 text-ui-blue-light rounded-lg shadow-md \n                               hover:bg-ui-blue-light/20 transition-colors duration-300 flex items-center \n                               dark:bg-ui-blue-dark/10 dark:text-ui-blue-dark dark:hover:bg-ui-blue-dark/20\"\n                    aria-label=\"Refresh file list\"\n                  >\n                    <RefreshCw size={18} className=\"mr-2\" /> Refresh Files\n                  </button>\n\n                  <button\n                    onClick={handleOpenSettings}\n                    className=\"px-4 py-2 bg-ui-blue-light/10 text-ui-blue-light rounded-lg shadow-md \n                               hover:bg-ui-blue-light/20 transition-colors duration-300 flex items-center \n                               dark:bg-ui-blue-dark/10 dark:text-ui-blue-dark dark:hover:bg-ui-blue-dark/20\"\n                    aria-label=\"Open settings\"\n                  >\n                    <Settings size={18} />\n                  </button>\n                </div>\n              </header>\n\n              {currentPage === 'dashboard' && (\n                <DashboardPage\n                  userProfile={userProfile}\n                  folders={folders}\n                  setCurrentPage={setCurrentPage}\n                  onLogout={handleLogout}\n                />\n              )}\n              {currentPage === 'incomingInvoices' && (\n                <IncomingInvoicesPage\n                  files={folders[FOLDER_NAMES.INCOMING_INVOICES]}\n                  setCurrentPage={setCurrentPage}\n                  onEdit={handleEditClick}\n                  onApprove={handleApprove}\n                  onView={handleView}\n                />\n              )}\n              {currentPage === 'publishedDocuments' && (\n                <PublishedDocumentsPage\n                  files={folders[FOLDER_NAMES.PUBLISHED_DOCUMENTS]}\n                  setCurrentPage={setCurrentPage}\n                  onView={handleView}\n                  onSent={handleSent}\n                />\n              )}\n              {currentPage === 'approvedInvoices' && (\n                <ApprovedInvoicesPage\n                  files={folders[FOLDER_NAMES.APPROVED_INVOICES]}\n                  setCurrentPage={setCurrentPage}\n                  onView={handleView}\n                />\n              )}\n              {currentPage === 'sentDocuments' && (\n                <SentDocumentsPage\n                  files={folders[FOLDER_NAMES.SENT_DOCUMENTS]}\n                  setCurrentPage={setCurrentPage}\n                  onView={handleView}\n                />\n              )}\n            </>\n          )}\n        </main>\n\n        <EditFileModal\n          isOpen={isEditModalOpen}\n          onClose={() => {\n            setIsEditModalOpen(false);\n            if (selectedFile && (selectedFile.type === 'pdf' || selectedFile.type === 'image' || selectedFile.type === 'other') && editedFileContent && typeof editedFileContent === 'string' && editedFileContent.startsWith('blob:')) {\n                URL.revokeObjectURL(editedFileContent);\n            }\n            setSelectedFile(null);\n            setEditedFileName('');\n            setEditedFileContent('');\n          }}\n          fileName={editedFileName}\n          onFileNameChange={(e) => setEditedFileName(e.target.value)}\n          fileContent={editedFileContent}\n          onFileContentChange={(e) => setEditedFileContent(e.target.value)}\n          onSave={handleSaveEdit}\n          selectedFileType={selectedFile?.type}\n          selectedFileMimeType={selectedFile?.mimeType}\n        />\n        <ViewFileModal\n          isOpen={isViewModalOpen}\n          onClose={() => {\n            setIsViewModalOpen(false);\n            if (selectedFile && (selectedFile.type === 'pdf' || selectedFile.type === 'image' || selectedFile.type === 'other') && editedFileContent && typeof editedFileContent === 'string' && editedFileContent.startsWith('blob:')) {\n                URL.revokeObjectURL(editedFileContent);\n            }\n            setSelectedFile(null);\n            setEditedFileContent('');\n          }}\n          fileName={selectedFile?.name || ''}\n          fileContent={editedFileContent}\n          selectedFileType={selectedFile?.type}\n          selectedFileMimeType={selectedFile?.mimeType}\n        />\n\n        <ConfirmModal\n          isOpen={isConfirmModalOpen}\n          onClose={() => setIsConfirmModalOpen(false)}\n          onConfirm={handleConfirmAction}\n          message={confirmActionDetails?.message || \"Are you sure you want to proceed?\"}\n        />\n      </div>\n    </ThemeContext.Provider>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}