{"ast":null,"code":"var _s = $RefreshSig$();\n// src/hooks/useGraph.js\nimport { useState, useCallback } from 'react';\nimport { getAccessToken, fetchFilesFromFolder, moveFile, downloadFileContent } from '../services/sharepointService';\nimport { FOLDER_DETAILS } from '../utils/constants';\nconst useGraph = (instance, accounts) => {\n  _s();\n  const [folders, setFolders] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const fetchSharePointData = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const accessToken = await getAccessToken(instance, accounts);\n      const folderPromises = Object.entries(FOLDER_DETAILS).map(async ([key, details]) => {\n        const files = await fetchFilesFromFolder(accessToken, details.id);\n        return {\n          [key]: files\n        };\n      });\n      const results = await Promise.all(folderPromises);\n      const allFolders = results.reduce((acc, current) => ({\n        ...acc,\n        ...current\n      }), {});\n      setFolders(allFolders);\n    } catch (e) {\n      console.error(\"Failed to fetch SharePoint data:\", e);\n      setError(\"Could not load files from SharePoint. Please refresh.\");\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts]);\n  const moveSharePointFile = useCallback(async (fileId, sourceFolderId, destinationFolderId) => {\n    setIsLoading(true);\n    try {\n      const accessToken = await getAccessToken(instance, accounts);\n      await moveFile(accessToken, fileId, destinationFolderId);\n      // No need to manually update state, fetchSharePointData will be called to refresh\n    } catch (e) {\n      console.error(\"Failed to move file:\", e);\n      throw new Error(\"Failed to move the file.\");\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts]);\n  const downloadFileFromSharePoint = useCallback(async file => {\n    setIsLoading(true);\n    try {\n      const accessToken = await getAccessToken(instance, accounts);\n      return await downloadFileContent(accessToken, file);\n    } catch (e) {\n      console.error(\"Failed to download file content:\", e);\n      throw new Error(\"Could not download file content.\");\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts]);\n  return {\n    folders,\n    isLoading,\n    error,\n    fetchSharePointData,\n    moveSharePointFile,\n    downloadFileFromSharePoint\n  };\n};\n_s(useGraph, \"SwFRa1imUGaySyRi0kqOEsmN1eE=\");\nexport default useGraph;","map":{"version":3,"names":["useState","useCallback","getAccessToken","fetchFilesFromFolder","moveFile","downloadFileContent","FOLDER_DETAILS","useGraph","instance","accounts","_s","folders","setFolders","isLoading","setIsLoading","error","setError","fetchSharePointData","accessToken","folderPromises","Object","entries","map","key","details","files","id","results","Promise","all","allFolders","reduce","acc","current","e","console","moveSharePointFile","fileId","sourceFolderId","destinationFolderId","Error","downloadFileFromSharePoint","file"],"sources":["/workspaces/InvoiceApp/src/hooks/useGraph.js"],"sourcesContent":["// src/hooks/useGraph.js\nimport { useState, useCallback } from 'react';\nimport { getAccessToken, fetchFilesFromFolder, moveFile, downloadFileContent } from '../services/sharepointService';\nimport { FOLDER_DETAILS } from '../utils/constants';\n\nconst useGraph = (instance, accounts) => {\n  const [folders, setFolders] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const fetchSharePointData = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const accessToken = await getAccessToken(instance, accounts);\n      const folderPromises = Object.entries(FOLDER_DETAILS).map(async ([key, details]) => {\n        const files = await fetchFilesFromFolder(accessToken, details.id);\n        return { [key]: files };\n      });\n      const results = await Promise.all(folderPromises);\n      const allFolders = results.reduce((acc, current) => ({ ...acc, ...current }), {});\n      setFolders(allFolders);\n    } catch (e) {\n      console.error(\"Failed to fetch SharePoint data:\", e);\n      setError(\"Could not load files from SharePoint. Please refresh.\");\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts]);\n\n  const moveSharePointFile = useCallback(async (fileId, sourceFolderId, destinationFolderId) => {\n    setIsLoading(true);\n    try {\n      const accessToken = await getAccessToken(instance, accounts);\n      await moveFile(accessToken, fileId, destinationFolderId);\n      // No need to manually update state, fetchSharePointData will be called to refresh\n    } catch (e) {\n      console.error(\"Failed to move file:\", e);\n      throw new Error(\"Failed to move the file.\");\n    } finally {\n      setIsLoading(false);\n    }\n  }, [instance, accounts]);\n  \n  const downloadFileFromSharePoint = useCallback(async (file) => {\n    setIsLoading(true);\n    try {\n        const accessToken = await getAccessToken(instance, accounts);\n        return await downloadFileContent(accessToken, file);\n    } catch(e) {\n        console.error(\"Failed to download file content:\", e);\n        throw new Error(\"Could not download file content.\");\n    } finally {\n        setIsLoading(false);\n    }\n  }, [instance, accounts]);\n\n  return { folders, isLoading, error, fetchSharePointData, moveSharePointFile, downloadFileFromSharePoint };\n};\n\nexport default useGraph;"],"mappings":";AAAA;AACA,SAASA,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AAC7C,SAASC,cAAc,EAAEC,oBAAoB,EAAEC,QAAQ,EAAEC,mBAAmB,QAAQ,+BAA+B;AACnH,SAASC,cAAc,QAAQ,oBAAoB;AAEnD,MAAMC,QAAQ,GAAGA,CAACC,QAAQ,EAAEC,QAAQ,KAAK;EAAAC,EAAA;EACvC,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGZ,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC1C,MAAM,CAACa,SAAS,EAAEC,YAAY,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACe,KAAK,EAAEC,QAAQ,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EAExC,MAAMiB,mBAAmB,GAAGhB,WAAW,CAAC,YAAY;IAClDa,YAAY,CAAC,IAAI,CAAC;IAClBE,QAAQ,CAAC,IAAI,CAAC;IACd,IAAI;MACF,MAAME,WAAW,GAAG,MAAMhB,cAAc,CAACM,QAAQ,EAAEC,QAAQ,CAAC;MAC5D,MAAMU,cAAc,GAAGC,MAAM,CAACC,OAAO,CAACf,cAAc,CAAC,CAACgB,GAAG,CAAC,OAAO,CAACC,GAAG,EAAEC,OAAO,CAAC,KAAK;QAClF,MAAMC,KAAK,GAAG,MAAMtB,oBAAoB,CAACe,WAAW,EAAEM,OAAO,CAACE,EAAE,CAAC;QACjE,OAAO;UAAE,CAACH,GAAG,GAAGE;QAAM,CAAC;MACzB,CAAC,CAAC;MACF,MAAME,OAAO,GAAG,MAAMC,OAAO,CAACC,GAAG,CAACV,cAAc,CAAC;MACjD,MAAMW,UAAU,GAAGH,OAAO,CAACI,MAAM,CAAC,CAACC,GAAG,EAAEC,OAAO,MAAM;QAAE,GAAGD,GAAG;QAAE,GAAGC;MAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MACjFrB,UAAU,CAACkB,UAAU,CAAC;IACxB,CAAC,CAAC,OAAOI,CAAC,EAAE;MACVC,OAAO,CAACpB,KAAK,CAAC,kCAAkC,EAAEmB,CAAC,CAAC;MACpDlB,QAAQ,CAAC,uDAAuD,CAAC;IACnE,CAAC,SAAS;MACRF,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC,EAAE,CAACN,QAAQ,EAAEC,QAAQ,CAAC,CAAC;EAExB,MAAM2B,kBAAkB,GAAGnC,WAAW,CAAC,OAAOoC,MAAM,EAAEC,cAAc,EAAEC,mBAAmB,KAAK;IAC5FzB,YAAY,CAAC,IAAI,CAAC;IAClB,IAAI;MACF,MAAMI,WAAW,GAAG,MAAMhB,cAAc,CAACM,QAAQ,EAAEC,QAAQ,CAAC;MAC5D,MAAML,QAAQ,CAACc,WAAW,EAAEmB,MAAM,EAAEE,mBAAmB,CAAC;MACxD;IACF,CAAC,CAAC,OAAOL,CAAC,EAAE;MACVC,OAAO,CAACpB,KAAK,CAAC,sBAAsB,EAAEmB,CAAC,CAAC;MACxC,MAAM,IAAIM,KAAK,CAAC,0BAA0B,CAAC;IAC7C,CAAC,SAAS;MACR1B,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC,EAAE,CAACN,QAAQ,EAAEC,QAAQ,CAAC,CAAC;EAExB,MAAMgC,0BAA0B,GAAGxC,WAAW,CAAC,MAAOyC,IAAI,IAAK;IAC7D5B,YAAY,CAAC,IAAI,CAAC;IAClB,IAAI;MACA,MAAMI,WAAW,GAAG,MAAMhB,cAAc,CAACM,QAAQ,EAAEC,QAAQ,CAAC;MAC5D,OAAO,MAAMJ,mBAAmB,CAACa,WAAW,EAAEwB,IAAI,CAAC;IACvD,CAAC,CAAC,OAAMR,CAAC,EAAE;MACPC,OAAO,CAACpB,KAAK,CAAC,kCAAkC,EAAEmB,CAAC,CAAC;MACpD,MAAM,IAAIM,KAAK,CAAC,kCAAkC,CAAC;IACvD,CAAC,SAAS;MACN1B,YAAY,CAAC,KAAK,CAAC;IACvB;EACF,CAAC,EAAE,CAACN,QAAQ,EAAEC,QAAQ,CAAC,CAAC;EAExB,OAAO;IAAEE,OAAO;IAAEE,SAAS;IAAEE,KAAK;IAAEE,mBAAmB;IAAEmB,kBAAkB;IAAEK;EAA2B,CAAC;AAC3G,CAAC;AAAC/B,EAAA,CArDIH,QAAQ;AAuDd,eAAeA,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}