{"ast":null,"code":"var _jsxFileName = \"/workspaces/InvoiceApp/src/App.js\",\n  _s = $RefreshSig$();\n// src/App.js\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useMsal, useIsAuthenticated } from '@azure/msal-react';\nimport { loginRequest } from './authConfig';\n\n// --- Hooks ---\nimport useGraph from './hooks/useGraph';\n\n// --- Your Original Pages ---\nimport LoginPage from './pages/LoginPage';\nimport DashboardPage from './pages/DashboardPage';\nimport IncomingInvoicesPage from './pages/IncomingInvoicePage';\nimport ApprovedInvoicesPage from './pages/ApprovedInvoicesPage';\nimport PublishedDocumentsPage from './pages/PublishedDocumentsPage';\nimport SentDocumentsPage from './pages/s';\n\n// --- Components ---\nimport LoadingSpinner from './components/LoadingSpinner';\nimport MessageDisplay from './components/MessageDisplay';\nimport Header from './components/Header';\nimport ConfirmModal from './components/ConfirmModal';\nimport ViewFileModal from './components/ViewFileModal';\nimport ExcelChoiceModal from './components/ExcelChoiceModal';\nimport SettingsModal from './components/SettingsModal';\nimport { FOLDER_DETAILS, FOLDER_NAMES } from './utils/constants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const {\n    instance,\n    accounts\n  } = useMsal();\n  const isAuthenticated = useIsAuthenticated();\n  const {\n    folders,\n    isLoading,\n    error,\n    fetchSharePointData,\n    moveSharePointFile,\n    downloadFileFromSharePoint\n  } = useGraph(instance, accounts);\n  const [userProfile, setUserProfile] = useState(null);\n  const [message, setMessage] = useState({\n    text: '',\n    type: ''\n  });\n  const [isDarkMode, setIsDarkMode] = useState(() => localStorage.getItem('theme') === 'dark');\n  const [currentPage, setCurrentPage] = useState('login');\n  const [modal, setModal] = useState(null);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [viewedFileContent, setViewedFileContent] = useState(null);\n  const [excelOpeningPreference, setExcelOpeningPreference] = useState(() => localStorage.getItem('excelOpeningPreference') || 'ask');\n  const showMessage = useCallback((text, type = 'info') => {\n    setMessage({\n      text,\n      type\n    });\n  }, []);\n  useEffect(() => {\n    if (isAuthenticated && accounts.length > 0) {\n      const fetchProfile = async () => {\n        try {\n          const response = await instance.acquireTokenSilent({\n            ...loginRequest,\n            account: accounts[0]\n          });\n          const graphResponse = await fetch('https://graph.microsoft.com/v1.0/me', {\n            headers: {\n              Authorization: `Bearer ${response.accessToken}`\n            }\n          });\n          const profile = await graphResponse.json();\n          setUserProfile(profile);\n          setCurrentPage('dashboard');\n          fetchSharePointData();\n        } catch (e) {\n          console.error(e);\n          showMessage('Could not fetch user profile.', 'error');\n        }\n      };\n      fetchProfile();\n    } else {\n      setCurrentPage('login');\n    }\n  }, [isAuthenticated, accounts, instance, fetchSharePointData, showMessage]);\n  useEffect(() => {\n    if (error) {\n      showMessage(error, 'error');\n    }\n  }, [error, showMessage]);\n  useEffect(() => {\n    localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');\n    document.documentElement.classList.toggle('dark', isDarkMode);\n  }, [isDarkMode]);\n  useEffect(() => {\n    localStorage.setItem('excelOpeningPreference', excelOpeningPreference);\n  }, [excelOpeningPreference]);\n\n  // FIX: This function now uses logoutRedirect for a smoother experience\n  const handleLogout = () => {\n    instance.logoutRedirect({\n      postLogoutRedirectUri: \"/\"\n    });\n  };\n  const handleMicrosoftLogin = () => instance.loginPopup(loginRequest).catch(e => console.error(e));\n  const handleExcelOpen = useCallback(file => {\n    if (excelOpeningPreference === 'ask') {\n      setModal('excelChoice');\n    } else if (excelOpeningPreference === 'web') {\n      window.open(file.webUrl, '_blank');\n    } else {\n      window.location.href = `ms-excel:ofe|u|${encodeURIComponent(file.webUrl)}`;\n    }\n  }, [excelOpeningPreference]);\n  const handleView = useCallback(async file => {\n    setSelectedFile(file);\n    if (file.type === 'xlsx') {\n      handleExcelOpen(file);\n    } else {\n      try {\n        const content = await downloadFileFromSharePoint(file);\n        setViewedFileContent(content);\n        setModal('viewFile');\n      } catch (e) {\n        showMessage(e.message, 'error');\n      }\n    }\n  }, [downloadFileFromSharePoint, handleExcelOpen, showMessage]);\n  const handleApprove = useCallback(fileId => {\n    var _folders$FOLDER_NAMES;\n    const fileToApprove = (_folders$FOLDER_NAMES = folders[FOLDER_NAMES.INCOMING_INVOICES]) === null || _folders$FOLDER_NAMES === void 0 ? void 0 : _folders$FOLDER_NAMES.find(f => f.id === fileId);\n    if (fileToApprove) {\n      setSelectedFile(fileToApprove);\n      setModal('confirmApproval');\n    }\n  }, [folders]);\n  const handleSent = useCallback(fileId => {\n    var _folders$FOLDER_NAMES2;\n    const fileToSend = (_folders$FOLDER_NAMES2 = folders[FOLDER_NAMES.PUBLISHED_DOCUMENTS]) === null || _folders$FOLDER_NAMES2 === void 0 ? void 0 : _folders$FOLDER_NAMES2.find(f => f.id === fileId);\n    if (fileToSend) {\n      setSelectedFile(fileToSend);\n      setModal('confirmSent');\n    }\n  }, [folders]);\n  const handleConfirm = useCallback(async () => {\n    if (!selectedFile || !modal) return;\n    const action = modal;\n    const originalFile = selectedFile;\n    setModal(null);\n    try {\n      let successMessage = '';\n      if (action === 'confirmApproval') {\n        const sourceFolderId = FOLDER_DETAILS.incomingInvoices.id;\n        const destFolderId = FOLDER_DETAILS.approvedInvoices.id;\n        await moveSharePointFile(originalFile.id, sourceFolderId, destFolderId);\n        successMessage = 'File approved successfully.';\n      } else if (action === 'confirmSent') {\n        const sourceFolderId = FOLDER_DETAILS.publishedDocuments.id;\n        const destFolderId = FOLDER_DETAILS.sentDocuments.id;\n        await moveSharePointFile(originalFile.id, sourceFolderId, destFolderId);\n        successMessage = 'File marked as sent.';\n      }\n      showMessage(successMessage, 'success');\n      fetchSharePointData();\n    } catch (e) {\n      showMessage(e.message, 'error');\n    }\n  }, [selectedFile, modal, moveSharePointFile, showMessage, fetchSharePointData]);\n  const renderPage = () => {\n    switch (currentPage) {\n      case 'dashboard':\n        return /*#__PURE__*/_jsxDEV(DashboardPage, {\n          userProfile: userProfile,\n          folders: folders,\n          setCurrentPage: setCurrentPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 20\n        }, this);\n      case 'incomingInvoices':\n        return /*#__PURE__*/_jsxDEV(IncomingInvoicesPage, {\n          files: folders[FOLDER_NAMES.INCOMING_INVOICES] || [],\n          setCurrentPage: setCurrentPage,\n          onView: handleView,\n          onApprove: handleApprove\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 20\n        }, this);\n      case 'approvedInvoices':\n        return /*#__PURE__*/_jsxDEV(ApprovedInvoicesPage, {\n          files: folders[FOLDER_NAMES.APPROVED_INVOICES] || [],\n          setCurrentPage: setCurrentPage,\n          onView: handleView\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 20\n        }, this);\n      case 'publishedDocuments':\n        return /*#__PURE__*/_jsxDEV(PublishedDocumentsPage, {\n          files: folders[FOLDER_NAMES.PUBLISHED_DOCUMENTS] || [],\n          setCurrentPage: setCurrentPage,\n          onView: handleView,\n          onSent: handleSent\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 20\n        }, this);\n      case 'sentDocuments':\n        return /*#__PURE__*/_jsxDEV(SentDocumentsPage, {\n          files: folders[FOLDER_NAMES.SENT_DOCUMENTS] || [],\n          setCurrentPage: setCurrentPage,\n          onView: handleView\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 20\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(LoginPage, {\n          onLogin: handleMicrosoftLogin\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 20\n        }, this);\n    }\n  };\n  const closeModal = () => {\n    setModal(null);\n    setSelectedFile(null);\n    if (viewedFileContent && viewedFileContent.startsWith('blob:')) {\n      URL.revokeObjectURL(viewedFileContent);\n    }\n    setViewedFileContent(null);\n  };\n  if (!isAuthenticated) {\n    return /*#__PURE__*/_jsxDEV(LoginPage, {\n      onLogin: handleMicrosoftLogin\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-light-bg-canvas dark:bg-dark-bg-card text-text-primary-light dark:text-text-primary-dark\",\n    children: [isLoading && /*#__PURE__*/_jsxDEV(LoadingSpinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 21\n    }, this), /*#__PURE__*/_jsxDEV(MessageDisplay, {\n      message: message,\n      onClearMessage: () => setMessage({\n        text: '',\n        type: ''\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Header, {\n      onLogout: handleLogout,\n      onRefresh: fetchSharePointData,\n      onSettingsClick: () => setModal('settings'),\n      setCurrentPage: setCurrentPage,\n      currentPage: currentPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"p-4 sm:p-6 md:p-8 max-w-7xl mx-auto w-full\",\n      children: renderPage()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ConfirmModal, {\n      isOpen: modal === 'confirmApproval' || modal === 'confirmSent',\n      onClose: closeModal,\n      onConfirm: handleConfirm,\n      title: modal === 'confirmApproval' ? \"Confirm Approval\" : \"Confirm Sent\",\n      message: `Are you sure you want to proceed with this action for \"${selectedFile === null || selectedFile === void 0 ? void 0 : selectedFile.name}\"?`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ViewFileModal, {\n      isOpen: modal === 'viewFile',\n      onClose: closeModal,\n      file: selectedFile,\n      content: viewedFileContent\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ExcelChoiceModal, {\n      isOpen: modal === 'excelChoice',\n      onClose: closeModal,\n      fileName: (selectedFile === null || selectedFile === void 0 ? void 0 : selectedFile.name) || '',\n      onOpenWeb: () => {\n        window.open(selectedFile === null || selectedFile === void 0 ? void 0 : selectedFile.webUrl, '_blank');\n        closeModal();\n      },\n      onOpenDesktop: () => {\n        window.location.href = `ms-excel:ofe|u|${encodeURIComponent(selectedFile === null || selectedFile === void 0 ? void 0 : selectedFile.webUrl)}`;\n        closeModal();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SettingsModal, {\n      isOpen: modal === 'settings',\n      onClose: closeModal,\n      isDarkMode: isDarkMode,\n      toggleDarkMode: () => setIsDarkMode(prev => !prev),\n      currentExcelPreference: excelOpeningPreference,\n      onPreferenceChange: setExcelOpeningPreference\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 197,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"vWdJJxn+eHAGI0k+lnDpaaD819c=\", false, function () {\n  return [useMsal, useIsAuthenticated, useGraph];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMsal","useIsAuthenticated","loginRequest","useGraph","LoginPage","DashboardPage","IncomingInvoicesPage","ApprovedInvoicesPage","PublishedDocumentsPage","SentDocumentsPage","LoadingSpinner","MessageDisplay","Header","ConfirmModal","ViewFileModal","ExcelChoiceModal","SettingsModal","FOLDER_DETAILS","FOLDER_NAMES","jsxDEV","_jsxDEV","App","_s","instance","accounts","isAuthenticated","folders","isLoading","error","fetchSharePointData","moveSharePointFile","downloadFileFromSharePoint","userProfile","setUserProfile","message","setMessage","text","type","isDarkMode","setIsDarkMode","localStorage","getItem","currentPage","setCurrentPage","modal","setModal","selectedFile","setSelectedFile","viewedFileContent","setViewedFileContent","excelOpeningPreference","setExcelOpeningPreference","showMessage","length","fetchProfile","response","acquireTokenSilent","account","graphResponse","fetch","headers","Authorization","accessToken","profile","json","e","console","setItem","document","documentElement","classList","toggle","handleLogout","logoutRedirect","postLogoutRedirectUri","handleMicrosoftLogin","loginPopup","catch","handleExcelOpen","file","window","open","webUrl","location","href","encodeURIComponent","handleView","content","handleApprove","fileId","_folders$FOLDER_NAMES","fileToApprove","INCOMING_INVOICES","find","f","id","handleSent","_folders$FOLDER_NAMES2","fileToSend","PUBLISHED_DOCUMENTS","handleConfirm","action","originalFile","successMessage","sourceFolderId","incomingInvoices","destFolderId","approvedInvoices","publishedDocuments","sentDocuments","renderPage","fileName","_jsxFileName","lineNumber","columnNumber","files","onView","onApprove","APPROVED_INVOICES","onSent","SENT_DOCUMENTS","onLogin","closeModal","startsWith","URL","revokeObjectURL","className","children","onClearMessage","onLogout","onRefresh","onSettingsClick","isOpen","onClose","onConfirm","title","name","onOpenWeb","onOpenDesktop","toggleDarkMode","prev","currentExcelPreference","onPreferenceChange","_c","$RefreshReg$"],"sources":["/workspaces/InvoiceApp/src/App.js"],"sourcesContent":["// src/App.js\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useMsal, useIsAuthenticated } from '@azure/msal-react';\nimport { loginRequest } from './authConfig';\n\n// --- Hooks ---\nimport useGraph from './hooks/useGraph';\n\n// --- Your Original Pages ---\nimport LoginPage from './pages/LoginPage';\nimport DashboardPage from './pages/DashboardPage';\nimport IncomingInvoicesPage from './pages/IncomingInvoicePage';\nimport ApprovedInvoicesPage from './pages/ApprovedInvoicesPage';\nimport PublishedDocumentsPage from './pages/PublishedDocumentsPage';\nimport SentDocumentsPage from './pages/s';\n\n// --- Components ---\nimport LoadingSpinner from './components/LoadingSpinner';\nimport MessageDisplay from './components/MessageDisplay';\nimport Header from './components/Header';\nimport ConfirmModal from './components/ConfirmModal';\nimport ViewFileModal from './components/ViewFileModal';\nimport ExcelChoiceModal from './components/ExcelChoiceModal';\nimport SettingsModal from './components/SettingsModal';\n\nimport { FOLDER_DETAILS, FOLDER_NAMES } from './utils/constants';\n\nfunction App() {\n  const { instance, accounts } = useMsal();\n  const isAuthenticated = useIsAuthenticated();\n  const {\n    folders,\n    isLoading,\n    error,\n    fetchSharePointData,\n    moveSharePointFile,\n    downloadFileFromSharePoint,\n  } = useGraph(instance, accounts);\n\n  const [userProfile, setUserProfile] = useState(null);\n  const [message, setMessage] = useState({ text: '', type: '' });\n  const [isDarkMode, setIsDarkMode] = useState(() => localStorage.getItem('theme') === 'dark');\n\n  const [currentPage, setCurrentPage] = useState('login');\n  const [modal, setModal] = useState(null);\n\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [viewedFileContent, setViewedFileContent] = useState(null);\n  const [excelOpeningPreference, setExcelOpeningPreference] = useState(() => localStorage.getItem('excelOpeningPreference') || 'ask');\n\n  const showMessage = useCallback((text, type = 'info') => {\n    setMessage({ text, type });\n  }, []);\n\n  useEffect(() => {\n    if (isAuthenticated && accounts.length > 0) {\n      const fetchProfile = async () => {\n        try {\n          const response = await instance.acquireTokenSilent({ ...loginRequest, account: accounts[0] });\n          const graphResponse = await fetch('https://graph.microsoft.com/v1.0/me', { headers: { Authorization: `Bearer ${response.accessToken}` } });\n          const profile = await graphResponse.json();\n          setUserProfile(profile);\n          setCurrentPage('dashboard');\n          fetchSharePointData();\n        } catch (e) {\n          console.error(e);\n          showMessage('Could not fetch user profile.', 'error');\n        }\n      };\n      fetchProfile();\n    } else {\n      setCurrentPage('login');\n    }\n  }, [isAuthenticated, accounts, instance, fetchSharePointData, showMessage]);\n\n  useEffect(() => {\n    if (error) {\n        showMessage(error, 'error');\n    }\n  }, [error, showMessage]);\n\n  useEffect(() => {\n    localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');\n    document.documentElement.classList.toggle('dark', isDarkMode);\n  }, [isDarkMode]);\n\n  useEffect(() => {\n    localStorage.setItem('excelOpeningPreference', excelOpeningPreference);\n  }, [excelOpeningPreference]);\n\n  // FIX: This function now uses logoutRedirect for a smoother experience\n  const handleLogout = () => {\n    instance.logoutRedirect({\n        postLogoutRedirectUri: \"/\",\n    });\n  };\n\n  const handleMicrosoftLogin = () => instance.loginPopup(loginRequest).catch(e => console.error(e));\n\n  const handleExcelOpen = useCallback((file) => {\n    if (excelOpeningPreference === 'ask') {\n      setModal('excelChoice');\n    } else if (excelOpeningPreference === 'web') {\n      window.open(file.webUrl, '_blank');\n    } else {\n      window.location.href = `ms-excel:ofe|u|${encodeURIComponent(file.webUrl)}`;\n    }\n  }, [excelOpeningPreference]);\n\n  const handleView = useCallback(async (file) => {\n    setSelectedFile(file);\n    if (file.type === 'xlsx') {\n        handleExcelOpen(file);\n    } else {\n        try {\n            const content = await downloadFileFromSharePoint(file);\n            setViewedFileContent(content);\n            setModal('viewFile');\n        } catch (e) {\n            showMessage(e.message, 'error');\n        }\n    }\n  }, [downloadFileFromSharePoint, handleExcelOpen, showMessage]);\n\n  const handleApprove = useCallback((fileId) => {\n    const fileToApprove = folders[FOLDER_NAMES.INCOMING_INVOICES]?.find(f => f.id === fileId);\n    if (fileToApprove) {\n        setSelectedFile(fileToApprove);\n        setModal('confirmApproval');\n    }\n  }, [folders]);\n\n  const handleSent = useCallback((fileId) => {\n    const fileToSend = folders[FOLDER_NAMES.PUBLISHED_DOCUMENTS]?.find(f => f.id === fileId);\n    if(fileToSend) {\n        setSelectedFile(fileToSend);\n        setModal('confirmSent');\n    }\n  }, [folders]);\n\n  const handleConfirm = useCallback(async () => {\n    if (!selectedFile || !modal) return;\n    const action = modal;\n    const originalFile = selectedFile;\n    setModal(null);\n    try {\n      let successMessage = '';\n      if (action === 'confirmApproval') {\n        const sourceFolderId = FOLDER_DETAILS.incomingInvoices.id;\n        const destFolderId = FOLDER_DETAILS.approvedInvoices.id;\n        await moveSharePointFile(originalFile.id, sourceFolderId, destFolderId);\n        successMessage = 'File approved successfully.';\n      } else if (action === 'confirmSent') {\n        const sourceFolderId = FOLDER_DETAILS.publishedDocuments.id;\n        const destFolderId = FOLDER_DETAILS.sentDocuments.id;\n        await moveSharePointFile(originalFile.id, sourceFolderId, destFolderId);\n        successMessage = 'File marked as sent.';\n      }\n      showMessage(successMessage, 'success');\n      fetchSharePointData();\n    } catch (e) {\n      showMessage(e.message, 'error');\n    }\n  }, [selectedFile, modal, moveSharePointFile, showMessage, fetchSharePointData]);\n\n  const renderPage = () => {\n    switch (currentPage) {\n        case 'dashboard':\n            return <DashboardPage userProfile={userProfile} folders={folders} setCurrentPage={setCurrentPage} />;\n        case 'incomingInvoices':\n            return <IncomingInvoicesPage files={folders[FOLDER_NAMES.INCOMING_INVOICES] || []} setCurrentPage={setCurrentPage} onView={handleView} onApprove={handleApprove} />;\n        case 'approvedInvoices':\n            return <ApprovedInvoicesPage files={folders[FOLDER_NAMES.APPROVED_INVOICES] || []} setCurrentPage={setCurrentPage} onView={handleView} />;\n        case 'publishedDocuments':\n            return <PublishedDocumentsPage files={folders[FOLDER_NAMES.PUBLISHED_DOCUMENTS] || []} setCurrentPage={setCurrentPage} onView={handleView} onSent={handleSent} />;\n        case 'sentDocuments':\n            return <SentDocumentsPage files={folders[FOLDER_NAMES.SENT_DOCUMENTS] || []} setCurrentPage={setCurrentPage} onView={handleView} />;\n        default:\n            return <LoginPage onLogin={handleMicrosoftLogin} />;\n    }\n  };\n\n  const closeModal = () => {\n    setModal(null);\n    setSelectedFile(null);\n    if (viewedFileContent && viewedFileContent.startsWith('blob:')) {\n      URL.revokeObjectURL(viewedFileContent);\n    }\n    setViewedFileContent(null);\n  };\n\n  if (!isAuthenticated) {\n    return <LoginPage onLogin={handleMicrosoftLogin} />;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-light-bg-canvas dark:bg-dark-bg-card text-text-primary-light dark:text-text-primary-dark\">\n      {isLoading && <LoadingSpinner />}\n      <MessageDisplay message={message} onClearMessage={() => setMessage({ text: '', type: '' })} />\n\n      <Header\n        onLogout={handleLogout}\n        onRefresh={fetchSharePointData}\n        onSettingsClick={() => setModal('settings')}\n        setCurrentPage={setCurrentPage}\n        currentPage={currentPage}\n      />\n\n      <main className=\"p-4 sm:p-6 md:p-8 max-w-7xl mx-auto w-full\">\n        {renderPage()}\n      </main>\n\n      <ConfirmModal\n        isOpen={modal === 'confirmApproval' || modal === 'confirmSent'}\n        onClose={closeModal}\n        onConfirm={handleConfirm}\n        title={modal === 'confirmApproval' ? \"Confirm Approval\" : \"Confirm Sent\"}\n        message={`Are you sure you want to proceed with this action for \"${selectedFile?.name}\"?`}\n      />\n      <ViewFileModal\n        isOpen={modal === 'viewFile'}\n        onClose={closeModal}\n        file={selectedFile}\n        content={viewedFileContent}\n      />\n      <ExcelChoiceModal\n        isOpen={modal === 'excelChoice'}\n        onClose={closeModal}\n        fileName={selectedFile?.name || ''}\n        onOpenWeb={() => { window.open(selectedFile?.webUrl, '_blank'); closeModal(); }}\n        onOpenDesktop={() => { window.location.href = `ms-excel:ofe|u|${encodeURIComponent(selectedFile?.webUrl)}`; closeModal(); }}\n      />\n      <SettingsModal\n        isOpen={modal === 'settings'}\n        onClose={closeModal}\n        isDarkMode={isDarkMode}\n        toggleDarkMode={() => setIsDarkMode(prev => !prev)}\n        currentExcelPreference={excelOpeningPreference}\n        onPreferenceChange={setExcelOpeningPreference}\n      />\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}